!function(window,document,undefined){function mousePosition(evt){if(window.event&&window.event.contentOverflow!==undefined)return{x:window.event.offsetX,y:window.event.offsetY};if(evt.offsetX!==undefined&&evt.offsetY!==undefined)return{x:evt.offsetX,y:evt.offsetY};var wrapper=evt.target.parentNode.parentNode;return{x:evt.layerX-wrapper.offsetLeft,y:evt.layerY-wrapper.offsetTop}}function $(el,attrs,children){el=document.createElementNS(svgNS,el);for(var key in attrs)el.setAttribute(key,attrs[key]);"[object Array]"!=Object.prototype.toString.call(children)&&(children=[children]);for(var i=0,len=children[0]&&children.length||0;len>i;i++)el.appendChild(children[i]);return el}function hsv2rgb(hsv){var R,G,B,X,C,h=hsv.h%360/60;C=hsv.v*hsv.s,X=C*(1-Math.abs(h%2-1)),R=G=B=hsv.v-C,h=~~h,R+=[C,X,0,0,X,C][h],G+=[X,C,C,X,0,0][h],B+=[0,0,X,C,C,X][h];var r=Math.floor(255*R),g=Math.floor(255*G),b=Math.floor(255*B);return{r:r,g:g,b:b,hex:"#"+(16777216|b|g<<8|r<<16).toString(16).slice(1)}}function rgb2hsv(rgb){var r=rgb.r,g=rgb.g,b=rgb.b;(rgb.r>1||rgb.g>1||rgb.b>1)&&(r/=255,g/=255,b/=255);var H,S,V,C;return V=Math.max(r,g,b),C=V-Math.min(r,g,b),H=0==C?null:V==r?(g-b)/C+(b>g?6:0):V==g?(b-r)/C+2:(r-g)/C+4,H=H%6*60,S=0==C?0:C/V,{h:H,s:S,v:V}}function slideListener(ctx,slideElement,pickerElement){return function(evt){evt=evt||window.event;var mouse=mousePosition(evt);ctx.h=mouse.y/slideElement.offsetHeight*360+hueOffset;var pickerColor=hsv2rgb({h:ctx.h,s:1,v:1}),c=hsv2rgb({h:ctx.h,s:ctx.s,v:ctx.v});pickerElement.style.backgroundColor=pickerColor.hex,ctx.callback&&ctx.callback(c.hex,{h:ctx.h-hueOffset,s:ctx.s,v:ctx.v},{r:c.r,g:c.g,b:c.b},undefined,mouse)}}function pickerListener(ctx,pickerElement){return function(evt){evt=evt||window.event;var mouse=mousePosition(evt),width=pickerElement.offsetWidth,height=pickerElement.offsetHeight;ctx.s=mouse.x/width,ctx.v=(height-mouse.y)/height;var c=hsv2rgb(ctx);ctx.callback&&ctx.callback(c.hex,{h:ctx.h-hueOffset,s:ctx.s,v:ctx.v},{r:c.r,g:c.g,b:c.b},mouse)}}function ColorPicker(slideElement,pickerElement,callback){if(!(this instanceof ColorPicker))return new ColorPicker(slideElement,pickerElement,callback);if(this.h=0,this.s=1,this.v=1,callback)this.callback=callback,this.pickerElement=pickerElement,this.slideElement=slideElement;else{var element=slideElement;element.innerHTML=colorpickerHTMLSnippet,this.slideElement=element.getElementsByClassName("slide")[0],this.pickerElement=element.getElementsByClassName("picker")[0];var slideIndicator=element.getElementsByClassName("slide-indicator")[0],pickerIndicator=element.getElementsByClassName("picker-indicator")[0];ColorPicker.fixIndicators(slideIndicator,pickerIndicator),this.callback=function(hex,hsv,rgb,pickerCoordinate,slideCoordinate){ColorPicker.positionIndicators(slideIndicator,pickerIndicator,slideCoordinate,pickerCoordinate),pickerElement(hex,hsv,rgb)}}if("SVG"==type){var slideClone=slide.cloneNode(!0),pickerClone=picker.cloneNode(!0),hsvGradient=slideClone.getElementById("gradient-hsv"),hsvRect=slideClone.getElementsByTagName("rect")[0];hsvGradient.id="gradient-hsv-"+uniqID,hsvRect.setAttribute("fill","url(#"+hsvGradient.id+")");var blackAndWhiteGradients=[pickerClone.getElementById("gradient-black"),pickerClone.getElementById("gradient-white")],whiteAndBlackRects=pickerClone.getElementsByTagName("rect");blackAndWhiteGradients[0].id="gradient-black-"+uniqID,blackAndWhiteGradients[1].id="gradient-white-"+uniqID,whiteAndBlackRects[0].setAttribute("fill","url(#"+blackAndWhiteGradients[1].id+")"),whiteAndBlackRects[1].setAttribute("fill","url(#"+blackAndWhiteGradients[0].id+")"),this.slideElement.appendChild(slideClone),this.pickerElement.appendChild(pickerClone),uniqID++}else this.slideElement.innerHTML=slide,this.pickerElement.innerHTML=picker;addEventListener(this.slideElement,"click",slideListener(this,this.slideElement,this.pickerElement)),addEventListener(this.pickerElement,"click",pickerListener(this,this.pickerElement)),enableDragging(this,this.slideElement,slideListener(this,this.slideElement,this.pickerElement)),enableDragging(this,this.pickerElement,pickerListener(this,this.pickerElement))}function addEventListener(element,event,listener){element.attachEvent?element.attachEvent("on"+event,listener):element.addEventListener&&element.addEventListener(event,listener,!1)}function enableDragging(ctx,element,listener){var mousedown=!1;addEventListener(element,"mousedown",function(){mousedown=!0}),addEventListener(element,"mouseup",function(){mousedown=!1}),addEventListener(element,"mouseout",function(){mousedown=!1}),addEventListener(element,"mousemove",function(evt){mousedown&&listener(evt)})}function setColor(ctx,hsv,rgb,hex){ctx.h=hsv.h%360,ctx.s=hsv.s,ctx.v=hsv.v;var c=hsv2rgb(ctx),mouseSlide={y:ctx.h*ctx.slideElement.offsetHeight/360,x:0},pickerHeight=ctx.pickerElement.offsetHeight,mousePicker={x:ctx.s*ctx.pickerElement.offsetWidth,y:pickerHeight-ctx.v*pickerHeight};return ctx.pickerElement.style.backgroundColor=hsv2rgb({h:ctx.h,s:1,v:1}).hex,ctx.callback&&ctx.callback(hex||c.hex,{h:ctx.h,s:ctx.s,v:ctx.v},rgb||{r:c.r,g:c.g,b:c.b},mousePicker,mouseSlide),ctx}var picker,slide,type=window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",hueOffset=15,svgNS="http://www.w3.org/2000/svg",colorpickerHTMLSnippet=['<div class="picker-wrapper">','<div class="picker"></div>','<div class="picker-indicator"></div>',"</div>",'<div class="slide-wrapper">','<div class="slide"></div>','<div class="slide-indicator"></div>',"</div>"].join("");"SVG"==type?(slide=$("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[$("defs",{},$("linearGradient",{id:"gradient-hsv",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[$("stop",{offset:"0%","stop-color":"#FF0000","stop-opacity":"1"}),$("stop",{offset:"13%","stop-color":"#FF00FF","stop-opacity":"1"}),$("stop",{offset:"25%","stop-color":"#8000FF","stop-opacity":"1"}),$("stop",{offset:"38%","stop-color":"#0040FF","stop-opacity":"1"}),$("stop",{offset:"50%","stop-color":"#00FFFF","stop-opacity":"1"}),$("stop",{offset:"63%","stop-color":"#00FF40","stop-opacity":"1"}),$("stop",{offset:"75%","stop-color":"#0BED00","stop-opacity":"1"}),$("stop",{offset:"88%","stop-color":"#FFFF00","stop-opacity":"1"}),$("stop",{offset:"100%","stop-color":"#FF0000","stop-opacity":"1"})])),$("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-hsv)"})]),picker=$("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%"},[$("defs",{},[$("linearGradient",{id:"gradient-black",x1:"0%",y1:"100%",x2:"0%",y2:"0%"},[$("stop",{offset:"0%","stop-color":"#000000","stop-opacity":"1"}),$("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})]),$("linearGradient",{id:"gradient-white",x1:"0%",y1:"100%",x2:"100%",y2:"100%"},[$("stop",{offset:"0%","stop-color":"#FFFFFF","stop-opacity":"1"}),$("stop",{offset:"100%","stop-color":"#CC9A81","stop-opacity":"0"})])]),$("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-white)"}),$("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#gradient-black)"})])):"VML"==type&&(slide=['<DIV style="position: relative; width: 100%; height: 100%">','<v:rect style="position: absolute; top: 0; left: 0; width: 100%; height: 100%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="0" color="red" color2="red" colors="8519f fuchsia;.25 #8000ff;24903f #0040ff;.5 aqua;41287f #00ff40;.75 #0bed00;57671f yellow"></v:fill>',"</v:rect>","</DIV>"].join(""),picker=['<DIV style="position: relative; width: 100%; height: 100%">','<v:rect style="position: absolute; left: -1px; top: -1px; width: 101%; height: 101%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="270" color="#FFFFFF" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>',"</v:rect>",'<v:rect style="position: absolute; left: 0px; top: 0px; width: 100%; height: 101%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="0" color="#000000" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>',"</v:rect>","</DIV>"].join(""),document.namespaces.v||document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"));var uniqID=0;ColorPicker.hsv2rgb=function(hsv){var rgbHex=hsv2rgb(hsv);return delete rgbHex.hex,rgbHex},ColorPicker.hsv2hex=function(hsv){return hsv2rgb(hsv).hex},ColorPicker.rgb2hsv=rgb2hsv,ColorPicker.rgb2hex=function(rgb){return hsv2rgb(rgb2hsv(rgb)).hex},ColorPicker.hex2hsv=function(hex){return rgb2hsv(ColorPicker.hex2rgb(hex))},ColorPicker.hex2rgb=function(hex){return{r:parseInt(hex.substr(1,2),16),g:parseInt(hex.substr(3,2),16),b:parseInt(hex.substr(5,2),16)}},ColorPicker.prototype.setHsv=function(hsv){return setColor(this,hsv)},ColorPicker.prototype.setRgb=function(rgb){return setColor(this,rgb2hsv(rgb),rgb)},ColorPicker.prototype.setHex=function(hex){return setColor(this,ColorPicker.hex2hsv(hex),undefined,hex)},ColorPicker.positionIndicators=function(slideIndicator,pickerIndicator,mouseSlide,mousePicker){mouseSlide&&(slideIndicator.style.top=mouseSlide.y-slideIndicator.offsetHeight/2+"px"),mousePicker&&(pickerIndicator.style.top=mousePicker.y-pickerIndicator.offsetHeight/2+"px",pickerIndicator.style.left=mousePicker.x-pickerIndicator.offsetWidth/2+"px")},ColorPicker.fixIndicators=function(slideIndicator,pickerIndicator){pickerIndicator.style.pointerEvents="none",slideIndicator.style.pointerEvents="none"},window.ColorPicker=ColorPicker}(window,window.document);var edittext=edittext||{};edittext=edittext||{},edittext.colorPickerFactory=function(editor,callback){var picker=editor.getElementsByClassName("picker")[0],pickerIndicador=editor.getElementsByClassName("picker-indicator")[0],slider=editor.getElementsByClassName("slider")[0],sliderIndicador=editor.getElementsByClassName("slider-indicator")[0];ColorPicker.fixIndicators(sliderIndicador,pickerIndicador);var btnCancel=editor.getElementsByClassName("button-cancel-color-picker")[0];return btnCancel.addEventListener("click",function(){editor.getElementsByClassName("edittext-color-picker")[0].style.display="none"},!0),ColorPicker(slider,picker,function(hex,hsv,rgb,pickerCoordinate,sliderCoordinate){ColorPicker.positionIndicators(sliderIndicador,pickerIndicador,sliderCoordinate,pickerCoordinate),callback(hex)})},edittext=edittext||{},edittext.comandoFactory={criar:function(editor,piframe,command){var iframe=piframe.contentDocument;return"bold"===command?new edittext.Bold(iframe):"italic"===command?new edittext.Italic(iframe):"underline"===command?new edittext.Underline(iframe):"fontSize"===command?new edittext.FontSize(iframe):"foreColor"===command?edittext.ForeColor(iframe,editor):"insertorderedlist"===command?new edittext.Insertorderedlist(iframe):"insertunorderedlist"===command?new edittext.Insertunorderedlist(iframe):"createLink"===command?new edittext.CreateLink(iframe):"unLink"===command?new edittext.UnLink(iframe):void 0}},edittext.editorFactory={criar:function(editor){return new edittext.Editor(editor)}},edittext=edittext||{},edittext.Bold=function(iframe){return{executar:function(){iframe.execCommand("bold",!1,null)}}},edittext=edittext||{},edittext.Comando=function(comando){if(!comando||!comando.executar)throw new Error("Informe o comando.");return function(){comando.executar()}},edittext=edittext||{},edittext.CreateLink=function(iframe){return{executar:function(){var link=prompt("Insira um link url","http://");iframe.execCommand("createLink",!1,link)}}},edittext=edittext||{},edittext.FontSize=function(iframe){return{executar:function(){var size=prompt("Informe o tamanho da fonte (1-7):","");iframe.execCommand("FontSize",!1,size)}}},edittext=edittext||{},edittext.ForeColor=function(iframe,editor){var _iframe=iframe,_editor=editor;return{executar:function(){_editor.controles.editorColorPicker.colorPickerElement.style.display="block"},setColor:function(hex){_iframe.execCommand("ForeColor",!1,hex)}}},edittext=edittext||{},edittext.Insertorderedlist=function(iframe){return{executar:function(){iframe.execCommand("insertorderedlist",!1,null)}}},edittext=edittext||{},edittext.Insertunorderedlist=function(iframe){return{executar:function(){iframe.execCommand("insertunorderedlist",!1,null)}}},edittext=edittext||{},edittext.Italic=function(iframe){return{executar:function(){iframe.execCommand("italic",!1,null)}}},edittext=edittext||{},edittext.UnLink=function(iframe){return{executar:function(){iframe.execCommand("unLink",!1,null)}}},edittext=edittext||{},edittext.Underline=function(iframe){return{executar:function(){iframe.execCommand("underline",!1,null)}}},edittext.Editor=function(editor){var command,self=this;self.elment=editor,self.elment.innerHTML=edittext.template();var buttons=[].slice.call(self.elment.querySelectorAll(".edittext-controles > button")),iframe=self.elment.querySelectorAll(".edittext-input > iframe")[0];iframe.contentDocument.designMode="on",buttons.forEach(function(button){command=button.getAttribute("data-command"),self[command]=edittext.comandoFactory.criar(self,iframe,command),button.addEventListener("click",function(){self[this.getAttribute("data-command")].executar()},!0)}),self.controles={editorColorPicker:{colorPicker:edittext.colorPickerFactory(self.elment,self.foreColor.setColor),colorPickerElement:self.elment.getElementsByClassName("edittext-color-picker")[0]}},self.getData=function(){return iframe.contentDocument.body.innerHTML},self.setData=function(data){iframe.contentDocument.body.innerHTML=data}},edittext.template=function(){var template=[];return template.push('<div class="edittext-controles">                                                                                                                                 '),template.push('		        <button type="button" data-command="bold" title="Negrito" class=""><span class="icon icon-bold"></span></button>                                    '),template.push('		        <button type="button" data-command="italic" title="Itálico" ><span class="icon icon-italic"></span></button>                                        '),template.push('		        <button type="button" data-command="underline" title="Sublinhado" class=""><span class="icon icon-underline"></span></button>                       '),template.push('		        <button type="button" data-command="fontSize" title="Tamanho da fonte" class=""><span class="icon icon-font-size"></span></button>                  '),template.push('		        <button type="button" data-command="foreColor" title="Cor da fonte" class=""><span class="icon icon-color-picker"></span></button>                  '),template.push('		        <button type="button" data-command="insertorderedlist" title="Lista ordenada" class=""><span class="icon icon-list-ordered"></span></button>        '),template.push('		        <button type="button" data-command="insertunorderedlist" title="Lista não ordenada" class=""><span class="icon icon-list-unordered"></span></button>'),template.push('		        <button type="button" data-command="createLink" title="Adicionar link" class=""><span class="icon icon-link"></span></button>                       '),template.push('		        <button type="button" data-command="unLink" title="Remover link" class=""><span class="icon icon-unlink"></span></button>                           '),template.push('		        <div class="edittext-color-picker">                                                                                                                 '),template.push('	        		<div class="picker-wrapper">                                                                                                                    '),template.push('			           <div class="picker"></div>                                                                                                                   '),template.push('			           <div class="picker-indicator"></div>                                                                                                         '),template.push("			        </div>                                                                                                                                          "),template.push('			        <div class="slider-wrapper">                                                                                                                    '),template.push('			           <div class="slider"></div>                                                                                                                   '),template.push('			           <div class="slider-indicator"></div>                                                                                                         '),template.push("			        </div>                                                                                                                                          "),template.push('			        <div class="edittext-color-picker-control">                                                                                                     '),template.push('			        	<button type="button" class="button-cancel-color-picker"><span class="icon icon-cancel"></span></button>                                    '),template.push("			        </div>                                                                                                                                          "),template.push("	        	</div>                                                                                                                                              "),template.push("	    	</div>                                                                                                                                                  "),template.push('	    	<div class="edittext-input">                                                                                                                            '),template.push('	    		<textarea name="" style="display:none;" id="" cols="30" rows="10"></textarea>                                                                       '),template.push("	    		<iframe></iframe>                                                                                                                                   "),template.push("	    	</div>                                                                                                                                                  "),template.join("")},edittext.editor={criarEditor:function(editor){var buttons=[].slice.call(editor.querySelectorAll(".edittext-controles > button")),iframe=editor.querySelectorAll(".edittext-input > iframe")[0];return iframe.contentDocument.designMode="on",buttons.forEach(function(button){button.addEventListener("click",edittext.comandoFactory.criar(iframe,button.getAttribute("data-command")),!0)}),{getData:function(){return iframe.contentDocument.body.innerHTML},setData:function(data){iframe.contentDocument.body.innerHTML=data}}}},function(){for(var idEditor,editores=document.querySelectorAll(".edittext"),countEditores=editores.length,i=0;countEditores>i;i++)idEditor=editores[i].getAttribute("id"),idEditor&&(edittext[idEditor]=edittext.editorFactory.criar(editores[i]))}();